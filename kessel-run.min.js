window.onload=function(){var t,s,e=1e4,i={},a=0,o=0,h=0,n=0,r=0,d=[],p=0,m=3,l=.05;i.StateTitle=function(){this.title,this.text,this.timer=0},i.StateTitle.prototype={preload:function(){this.game.load.image("title","assets/title.png"),this.game.load.bitmapFont("dosfont","assets/font/dos.png","assets/font/dos.fnt")},create:function(){this.title=u.add.sprite(u.world.centerX,u.world.centerY,"title"),this.title.anchor.setTo(.5,.5),this.game.input.keyboard.addKeyCapture([Phaser.Keyboard.SPACEBAR]),this.text=this.game.add.bitmapText(u.world.centerX,500,"dosfont","Press Spacebar",32),this.text.x=this.game.width/2-this.text.textWidth/2},update:function(){u.input.keyboard.isDown(Phaser.Keyboard.SPACEBAR)&&this.gotoStateJob(),this.timer+=this.game.time.elapsed,this.timer>=500&&(this.timer=0,this.text.visible=!this.text.visible)},gotoStateJob:function(){this.state.start("StateJob")}},i.StateJob={},i.StateJob=function(){this.bg,this.stars,this.timer=0,this.choiceText="",this.choice=-1,this.backspace,this.enter},i.StateJob.prototype={preload:function(){this.game.load.bitmapFont("dosfont","assets/font/dos.png","assets/font/dos.fnt"),this.game.load.image("background","assets/background.png"),this.game.load.image("stars","assets/stars.png"),this.game.load.image("divider","assets/divider.png")},create:function(){this.bg=this.game.add.tileSprite(0,0,800,600,"background"),this.stars=this.game.add.tileSprite(0,0,800,600,"stars"),u.add.sprite(0,10,"divider"),u.add.sprite(0,545,"divider"),this.text=this.game.add.bitmapText(100,100,"dosfont","You May: \n\n1. Be an investment banker from\n   New Boston\n2. Be a doctor from Osiris\n3. Be a space cowboy from Mos Eisley\n\nWhat is your choice?",32),this.cursor=this.game.add.bitmapText(450,320,"dosfont","_",32),this.choiceText=this.game.add.bitmapText(450,325,"dosfont","",32),u.input.keyboard.addKeyCapture([Phaser.Keyboard.BACKSPACE,Phaser.Keyboard.ENTER]),this.enter=u.input.keyboard.addKey(Phaser.Keyboard.ENTER),this.enter.onDown.add(this.submitChoice,this),this.backspace=u.input.keyboard.addKey(Phaser.Keyboard.BACKSPACE),this.backspace.onDown.add(this.deleteChoice,this),u.input.keyboard.addCallbacks(this,null,null,this.keyPress)},update:function(){this.stars.tilePosition.x+=.5,this.bg.tilePosition.x-=.5,this.timer+=this.game.time.elapsed,this.timer>=500&&(this.timer=0,this.cursor.visible=!this.cursor.visible)},deleteChoice:function(){-1!=this.choice&&(this.choice=-1,this.cursor.x-=26,this.choiceText.setText(""))},submitChoice:function(){-1!=this.choice&&(t=this.choice,1==t&&(e+=5e3),this.state.start("StateCaptain"))},keyPress:function(t){"1"===t?(this.choiceText.setText("1"),-1==this.choice&&(this.cursor.x+=26),this.choice=1):"2"===t?(this.choiceText.setText("2"),-1==this.choice&&(this.cursor.x+=26),this.choice=2):"3"===t&&(this.choiceText.setText("3"),-1==this.choice&&(this.cursor.x+=26),this.choice=3)}},i.StateCaptain={},i.StateCaptain=function(){this.bg,this.stars,this.party,this.text,this.cursor,this.choiceText,this.timer=0,this.name=""},i.StateCaptain.prototype={preload:function(){this.game.load.bitmapFont("dosfont","assets/font/dos.png","assets/font/dos.fnt"),this.game.load.image("background","assets/background.png"),this.game.load.image("stars","assets/stars.png"),this.game.load.image("party","assets/party.png")},create:function(){this.bg=this.game.add.tileSprite(0,0,800,600,"background"),this.stars=this.game.add.tileSprite(0,0,800,600,"stars"),this.party=this.game.add.sprite(0,0,"party"),this.text=this.game.add.bitmapText(100,305,"dosfont","What is the name of you captain?",32),this.cursor=this.game.add.bitmapText(100,337,"dosfont","_",32),this.choiceText=this.game.add.bitmapText(100,337,"dosfont","",32),u.input.keyboard.addKeyCapture([Phaser.Keyboard.BACKSPACE,Phaser.Keyboard.ENTER,Phaser.Keyboard.SPACEBAR]),this.enter=u.input.keyboard.addKey(Phaser.Keyboard.ENTER),this.enter.onDown.add(this.submitChoice,this),this.backspace=u.input.keyboard.addKey(Phaser.Keyboard.BACKSPACE),this.backspace.onDown.add(this.deleteChoice,this),this.spacebar=u.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),this.spacebar.onDown.add(this.addSpace,this),u.input.keyboard.addCallbacks(this,null,null,this.keyPress)},update:function(){this.stars.tilePosition.x+=.5,this.bg.tilePosition.x-=.5,this.timer+=this.game.time.elapsed,this.timer>=500&&(this.timer=0,this.cursor.visible=!this.cursor.visible)},keyPress:function(t){this.name+=t,this.choiceText.setText(this.name),this.cursor.x=126+this.choiceText.width},deleteChoice:function(){this.name=this.name.substring(0,this.name.length-1),this.choiceText.setText(this.name),this.cursor.x=100+this.choiceText.width,this.name.length>0&&(this.cursor.x+=26)},submitChoice:function(){s="Cpt. "+this.name,d.push({name:s,status:"healthy",hp:7}),this.state.start("StateParty")},addSpace:function(){this.name+=" ",this.choiceText.setText(this.name),this.cursor.x=126+this.choiceText.width}},i.StateParty={},i.StateParty=function(){this.bg,this.stars,this.party,this.text,this.cursor,this.choiceText=[],this.timer=0,this.members=["","","","",""],this.current_member=1},i.StateParty.prototype={preload:function(){this.game.load.bitmapFont("dosfont","assets/font/dos.png","assets/font/dos.fnt"),this.game.load.image("background","assets/background.png"),this.game.load.image("stars","assets/stars.png"),this.game.load.image("party","assets/party.png")},create:function(){this.bg=this.game.add.tileSprite(0,0,800,600,"background"),this.stars=this.game.add.tileSprite(0,0,800,600,"stars"),this.party=this.game.add.sprite(0,0,"party"),this.text=this.game.add.bitmapText(100,305,"dosfont","What are the names of the rest of your\ncrew?",32),this.cursor=this.game.add.bitmapText(132,401,"dosfont","_",32),this.members[0]=s;for(var t=0;5>t;t++)this.choiceText.push(this.game.add.bitmapText(100,369+32*t,"dosfont",t+1+". "+this.members[t]));u.input.keyboard.addKeyCapture([Phaser.Keyboard.BACKSPACE,Phaser.Keyboard.ENTER,Phaser.Keyboard.SPACEBAR]),this.enter=u.input.keyboard.addKey(Phaser.Keyboard.ENTER),this.enter.onDown.add(this.submitChoice,this),this.backspace=u.input.keyboard.addKey(Phaser.Keyboard.BACKSPACE),this.backspace.onDown.add(this.deleteChoice,this),this.spacebar=u.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR),this.spacebar.onDown.add(this.addSpace,this),u.input.keyboard.addCallbacks(this,null,null,this.keyPress)},update:function(){this.stars.tilePosition.x+=.5,this.bg.tilePosition.x-=.5,this.timer+=this.game.time.elapsed,this.timer>=500&&(this.timer=0,this.cursor.visible=!this.cursor.visible)},keyPress:function(t){this.members[this.current_member]+=t,this.choiceText[this.current_member].setText(this.current_member+1+". "+this.members[this.current_member]),this.cursor.x=126+this.choiceText[this.current_member].width},deleteChoice:function(){this.members[this.current_member]=this.members[this.current_member].substring(0,this.members[this.current_member].length-1),this.choiceText[this.current_member].setText(this.current_member+1+". "+this.members[this.current_member]),this.cursor.x=126+this.choiceText[this.current_member].width,this.members[this.current_member].length>0&&(this.cursor.x+=26)},submitChoice:function(){d.push({name:this.members[this.current_member],status:"healthy",hp:7}),this.current_member<4?(this.current_member++,this.cursor.y+=32,this.cursor.x=132):this.state.start("StateShop")},addSpace:function(){this.members[this.current_member]+=" ",this.choiceText[this.current_member].setText(this.current_member+1+". "+this.members[this.current_member]),this.cursor.x=126+this.choiceText[this.current_member].width}},i.StateShop={},i.StateShop=function(){this.solar_amount=0,this.food_amount=0,this.clothing_amount=0,this.parts_amount=0,this.spice_amount=0,this.solar_text,this.food_text,this.clothing_text,this.parts_text,this.spice_text,this.total=0,this.total_text,this.enter_text,this.timer=0},i.StateShop.prototype={preload:function(){this.game.load.image("merchant","assets/merchant.png"),this.game.load.image("arrow","assets/arrow.png"),this.game.load.bitmapFont("dosfont","assets/font/dos.png","assets/font/dos.fnt")},create:function(){this.merchant=this.game.add.sprite(100,300,"merchant"),this.merchant.anchor.setTo(.5,.5),this.merchant.scale.x=.5,this.merchant.scale.y=.5,this.game.add.bitmapText(200,20,"dosfont","Wimateeka's Shoppe",40),this.game.add.bitmapText(200,70,"dosfont","1. Solar Panels @ $500",32),this.game.add.bitmapText(200,132,"dosfont","2. Food         @ $10",32),this.game.add.bitmapText(200,194,"dosfont","3. Clothing     @ $40",32),this.game.add.bitmapText(200,256,"dosfont","4. Spare Parts  @ $100",32),this.game.add.bitmapText(200,318,"dosfont","5. Spice        @ $100",32),this.solar_text=this.game.add.bitmapText(600,70,"dosfont","0",32),this.solar_up=this.game.add.sprite(590,55,"arrow"),this.solar_up.inputEnabled=!0,this.solar_up.events.onInputOver.add(this.fade,this),this.solar_up.events.onInputDown.add(this.solarUp,this),this.solar_up.events.onInputOut.add(this.fade,this),this.solar_down=this.game.add.sprite(608,100,"arrow"),this.solar_down.anchor.setTo(.5,.5),this.solar_down.angle=180,this.solar_down.inputEnabled=!0,this.solar_down.events.onInputOver.add(this.fade,this),this.solar_down.events.onInputDown.add(this.solarDown,this),this.solar_down.events.onInputOut.add(this.fade,this),this.food_text=this.game.add.bitmapText(600,132,"dosfont","0",32),this.food_up=this.game.add.sprite(590,117,"arrow"),this.food_up.inputEnabled=!0,this.food_up.events.onInputOver.add(this.fade,this),this.food_up.events.onInputDown.add(this.foodUp,this),this.food_up.events.onInputOut.add(this.fade,this),this.food_down=this.game.add.sprite(608,162,"arrow"),this.food_down.anchor.setTo(.5,.5),this.food_down.angle=180,this.food_down.inputEnabled=!0,this.food_down.events.onInputOver.add(this.fade,this),this.food_down.events.onInputDown.add(this.foodDown,this),this.food_down.events.onInputOut.add(this.fade,this),this.clothing_text=this.game.add.bitmapText(600,194,"dosfont","0",32),this.clothing_up=this.game.add.sprite(590,179,"arrow"),this.clothing_up.inputEnabled=!0,this.clothing_up.events.onInputOver.add(this.fade,this),this.clothing_up.events.onInputDown.add(this.clothingUp,this),this.clothing_up.events.onInputOut.add(this.fade,this),this.clothing_down=this.game.add.sprite(608,225,"arrow"),this.clothing_down.anchor.setTo(.5,.5),this.clothing_down.angle=180,this.clothing_down.inputEnabled=!0,this.clothing_down.events.onInputOver.add(this.fade,this),this.clothing_down.events.onInputDown.add(this.clothingDown,this),this.clothing_down.events.onInputOut.add(this.fade,this),this.parts_text=this.game.add.bitmapText(600,256,"dosfont","0",32),this.parts_up=this.game.add.sprite(590,241,"arrow"),this.parts_up.inputEnabled=!0,this.parts_up.events.onInputOver.add(this.fade,this),this.parts_up.events.onInputDown.add(this.partsUp,this),this.parts_up.events.onInputOut.add(this.fade,this),this.parts_down=this.game.add.sprite(608,288,"arrow"),this.parts_down.anchor.setTo(.5,.5),this.parts_down.angle=180,this.parts_down.inputEnabled=!0,this.parts_down.events.onInputOver.add(this.fade,this),this.parts_down.events.onInputDown.add(this.partsDown,this),this.parts_down.events.onInputOut.add(this.fade,this),this.spice_text=this.game.add.bitmapText(600,318,"dosfont","0",32),this.spice_up=this.game.add.sprite(590,303,"arrow"),this.spice_up.inputEnabled=!0,this.spice_up.events.onInputOver.add(this.fade,this),this.spice_up.events.onInputDown.add(this.spiceUp,this),this.spice_up.events.onInputOut.add(this.fade,this),this.spice_down=this.game.add.sprite(608,349,"arrow"),this.spice_down.anchor.setTo(.5,.5),this.spice_down.angle=180,this.spice_down.inputEnabled=!0,this.spice_down.events.onInputOver.add(this.fade,this),this.spice_down.events.onInputDown.add(this.spiceDown,this),this.spice_down.events.onInputOut.add(this.fade,this),this.money=this.game.add.bitmapText(200,450,"dosfont","Your Funds: $"+e.toFixed(2),32),this.total_text=this.game.add.bitmapText(200,500,"dosfont","     Total: $0.00",32),this.enter_text=this.game.add.bitmapText(u.world.centerX,550,"dosfont","Press Enter to Continue",32),this.enter_text.x=this.game.width/2-this.enter_text.textWidth/2,this.enter=u.input.keyboard.addKey(Phaser.Keyboard.ENTER),this.enter.onDown.add(this.submitPurchase,this)},update:function(){this.timer+=this.game.time.elapsed,this.timer>=500&&(this.timer=0,this.enter_text.visible=!this.enter_text.visible)},solarUp:function(){this.total+500<=e&&(this.solar_amount++,this.solar_text.setText(this.solar_amount),this.total+=500,this.total_text.setText("     Total: $"+this.total.toFixed(2)))},solarDown:function(){this.solar_amount>0&&(this.solar_amount--,this.solar_text.setText(this.solar_amount),this.total-=500,this.total_text.setText("     Total: $"+this.total.toFixed(2)))},foodUp:function(){this.total+10<=e&&(this.food_amount++,this.food_text.setText(this.food_amount),this.total+=10,this.total_text.setText("     Total: $"+this.total.toFixed(2)))},foodDown:function(){this.food_amount>0&&(this.food_amount--,this.food_text.setText(this.food_amount),this.total-=10,this.total_text.setText("     Total: $"+this.total.toFixed(2)))},clothingUp:function(){this.total+40<=e&&(this.clothing_amount++,this.clothing_text.setText(this.clothing_amount),this.total+=40,this.total_text.setText("     Total: $"+this.total.toFixed(2)))},clothingDown:function(){this.clothing_amount>0&&(this.clothing_amount--,this.clothing_text.setText(this.clothing_amount),this.total-=40,this.total_text.setText("     Total: $"+this.total.toFixed(2)))},partsUp:function(){this.total+100<=e&&(this.parts_amount++,this.parts_text.setText(this.parts_amount),this.total+=100,this.total_text.setText("     Total: $"+this.total.toFixed(2)))},partsDown:function(){this.parts_amount>0&&(this.parts_amount--,this.parts_text.setText(this.parts_amount),this.total-=100,this.total_text.setText("     Total: $"+this.total.toFixed(2)))},spiceUp:function(){this.total+100<=e&&(this.spice_amount++,this.spice_text.setText(this.spice_amount),this.total+=100,this.total_text.setText("     Total: $"+this.total.toFixed(2)))},spiceDown:function(){this.spice_amount>0&&(this.spice_amount--,this.spice_text.setText(this.spice_amount),this.total-=100,this.total_text.setText("     Total: $"+this.total.toFixed(2)))},fade:function(t){t.alpha=.8!=t.alpha?.8:1},submitPurchase:function(){e-=this.total,a=this.solar_amount,o=this.food_amount,h=this.clothing_amount,n=this.parts_amount,r=this.spice_amount,this.state.start("StateStartStation")}},i.StateStartStation={},i.StateStartStation=function(){this.station,this.music,this.enter_text,this.timer=0},i.StateStartStation.prototype={preload:function(){this.game.load.image("station","assets/station.png"),this.game.load.audio("music","assets/audio/SpaceGone-8bit-Chiptune-Song-36.mp3"),this.game.load.bitmapFont("dosfont","assets/font/dos.png","assets/font/dos.fnt")},create:function(){this.station=this.game.add.sprite(0,0,"station"),this.music=this.game.add.audio("music"),this.music.loop=!0,this.music.play(),this.enter_text=this.game.add.bitmapText(u.world.centerX,u.world.centerY,"dosfont","Press Enter to Take Off",64),this.enter_text.x=this.game.width/2-this.enter_text.textWidth/2,this.enter=u.input.keyboard.addKey(Phaser.Keyboard.ENTER),this.enter.onDown.add(this.takeOff,this)},update:function(){this.timer+=this.game.time.elapsed,this.timer>=500&&(this.timer=0,this.enter_text.visible=!this.enter_text.visible)},takeOff:function(){this.music.stop(),this.state.start("StateTravel")}},i.StateTravel={},i.StateTravel=function(){this.progressLine,this.shipProgress,this.ship,this.solar_status,this.food_status,this.clothing_status,this.parts_status,this.spice_status,this.crew_statuses,this.rest,this.distanceTraveled=0,this.timer=0,this.dayTimer=0,this.restTimer=0,this.day_status,this.resting=!1,this.meal_buttons,this.speed_buttons,this.sicknesses=["Space Madness","Space Dysentery","Space Cholera","Exhaustion"]},i.StateTravel.prototype={preload:function(){this.game.load.image("ship","assets/ship.png"),this.game.load.bitmapFont("dosfont","assets/font/dos.png","assets/font/dos.fnt"),this.game.load.image("background","assets/background.png"),this.game.load.image("stars","assets/stars.png"),this.game.load.image("divider","assets/divider.png"),this.game.load.image("rest","assets/rest.png"),this.game.load.image("food","assets/food.png"),this.game.load.image("1meals","assets/1meal.png"),this.game.load.image("2meals","assets/2meals.png"),this.game.load.image("3meals","assets/3meals.png"),this.game.load.image("speed1","assets/slow.png"),this.game.load.image("speed2","assets/moderate.png"),this.game.load.image("speed3","assets/fast.png")},create:function(){this.bg=this.game.add.tileSprite(0,0,800,600,"background"),this.stars=this.game.add.tileSprite(0,0,800,600,"stars"),this.progressLine=this.game.add.graphics(0,0),this.progressLine.lineStyle(1,16777215,.75),this.progressLine.moveTo(50,50),this.progressLine.lineTo(u.width-50,50),this.shipProgress=this.game.add.sprite(u.width-50,50,"ship"),this.shipProgress.anchor.setTo(.5,.5),this.shipProgress.scale.x=.2,this.shipProgress.scale.y=.2,this.shipProgress.angle=180,this.ship=this.game.add.sprite(this.game.world.centerX,this.game.world.centerY,"ship"),this.ship.angle=180,this.ship.anchor.setTo(.5,.5),this.solar_status=this.game.add.bitmapText(50,60,"dosfont","Solar Panels: "+a,26),this.food_status=this.game.add.bitmapText(50,86,"dosfont","Food: "+o,26),this.clothing_status=this.game.add.bitmapText(50,112,"dosfont","Clothing: "+h,26),this.parts_status=this.game.add.bitmapText(50,138,"dosfont","Spare Parts: "+n,26),this.spice_status=this.game.add.bitmapText(50,164,"dosfont","Spice: "+r,26),this.money_status=this.game.add.bitmapText(50,190,"dosfont","Money: $"+e.toFixed(2),26),this.day_status=this.game.add.bitmapText(700,60,"dosfont","Day: "+p,26),this.line1=this.game.add.sprite(50,216,"divider"),this.line1.scale.x=.3,this.line1.scale.y=.3,this.crew_statuses=u.add.group();for(var t=0;t<d.length;t++)this.status=this.game.add.bitmapText(50,236+26*t,"dosfont",d[t].name+": "+d[t].status,26),this.crew_statuses.add(this.status);this.rest=this.game.add.sprite(50,380,"rest"),this.rest.inputEnabled=!0,this.rest.events.onInputOver.add(this.fade,this),this.rest.events.onInputDown.add(this.enableRest,this),this.rest.events.onInputOut.add(this.fade,this),this.food=this.game.add.sprite(50,414,"food"),this.food.inputEnabled=!0,this.food.events.onInputOver.add(this.fade,this),this.food.events.onInputDown.add(this.gotoAsteroids,this),this.food.events.onInputOut.add(this.fade,this),this.game.add.bitmapText(700,98,"dosfont","Rations",26),this.meal_buttons=u.add.group();for(var t=0;3>t;t++)this.meal_button=this.game.add.sprite(700,126+34*t,t+1+"meals"),this.meal_buttons.add(this.meal_button),this.meal_button.inputEnabled=!0,this.meal_button.events.onInputOver.add(this.fade,this),this.meal_button.events.onInputDown.add(this.mealChanged,{amount:t+1}),this.meal_button.events.onInputOut.add(this.fade,this),2==t&&(this.meal_button.tint=5592405);this.game.add.bitmapText(700,230,"dosfont","Speed",26),this.speed_buttons=u.add.group();for(var t=0;3>t;t++)this.speed_button=this.game.add.sprite(700,256+34*t,"speed"+(t+1)),this.speed_buttons.add(this.speed_button),this.speed_button.inputEnabled=!0,this.speed_button.events.onInputOver.add(this.fade,this),this.speed_button.events.onInputDown.add(this.speedChanged,{index:t}),this.speed_button.events.onInputOut.add(this.fade,this),2==t&&(this.speed_button.tint=5592405);this.message=this.game.add.bitmapText(100,500,"dosfont","",26)},update:function(){0!=a||this.resting||(l=.03),this.resting?(this.stars.tilePosition.x+=.5,this.bg.tilePosition.x-=.5):(this.stars.tilePosition.x+=100*l,this.bg.tilePosition.x-=100*l);for(var s=0;3>s;s++)this.meal_buttons.getAt(s).tint=s==m-1?5592405:16777215;if(this.speed_buttons.setAll("tint",16777215),.03==l?this.speed_buttons.getAt(0).tint=5592405:.04==l?this.speed_buttons.getAt(1).tint=5592405:this.speed_buttons.getAt(2).tint=5592405,this.resting||(this.timer+=this.game.time.elapsed,this.timer>=500&&(this.timer=0,this.distanceTraveled+=l,this.distanceTraveled>58&&(this.distanceTraveled=58),this.shipProgress.x=750-this.distanceTraveled/58*700)),this.resting&&(this.restTimer+=this.game.time.elapsed,this.restTimer>=5e3)){this.restTimer=0,this.resting=!1,this.rest.tint=16777215,this.probabilityHealing=50,2==t&&(this.probabilityHealing+=20);for(var s=0;s<d.length;s++)("starving"!=d[s].status||"healthy"!=d[s].status)&&d[s].hp>0&&Math.floor(100*Math.random())+1<=this.probabilityHealing&&(d[s].status="healthy",this.crew_statuses.getAt(s).setText(d[s].name+": "+d[s].status))}if(this.dayTimer+=this.game.time.elapsed,this.dayTimer>=5e3){this.dayTimer=0,p++,this.randomEvent();for(var s=0;s<d.length;s++)"starving"!=d[s].status&&"healthy"!=d[s].status&&d[s].hp--,o>0&&d[s].hp>0?(o-=m,0>o&&(o=0),"starving"==d[s].status&&(d[s].status="healthy")):0==o&&d[s].hp>0?(d[s].hp--,"healthy"==d[s].status&&(d[s].status="starving")):d[s].status="dead",this.crew_statuses.getAt(s).setText(d[s].name+": "+d[s].status);this.day_status.setText("Day:"+p),this.food_status.setText("Food: "+o)}this.gameover=!0;for(var s=0;s<d.length;s++)if("dead"!=d[s].status){this.gameover=!1;break}this.gameover&&this.gotoGameOver(),58==this.distanceTraveled&&this.gotoWin()},gotoAsteroids:function(){this.state.start("StateAsteroids")},fade:function(t){t.alpha=.8!=t.alpha?.8:1},enableRest:function(){this.resting||(this.resting=!0,this.rest.tint=5592405)},mealChanged:function(){m=this.amount},speedChanged:function(){l=0==this.index?.03:1==this.index?.04:.05},gotoGameOver:function(){this.state.start("StateGameOver")},gotoWin:function(){this.state.start("StateWin")},randomEvent:function(){this.pick=Math.floor(3*Math.random())+1,1==this.pick?(this.sicknessProb=10+3/m+5/h,Math.floor(100*Math.random())+1<=this.sicknessProb&&(this.crewIndex=Math.floor(Math.random()*d.length),this.sickPerson=d[this.crewIndex],this.sickPerson.status=this.sicknesses[Math.floor(Math.random()*this.sicknesses.length)],this.message.setText(this.sickPerson.name+" has come down with "+this.sickPerson.status),this.crew_statuses.getAt(this.crewIndex).setText(d[this.crewIndex].name+": "+d[this.crewIndex].status))):2==this.pick?(this.brokenPartProb=10+100*l,3==t&&(this.brokenPartProb-=5),Math.floor(100*Math.random())+1<=this.brokenPartProb&&(n>0?(n--,this.parts_status.setText("Spare Parts: "+n),this.message.setText("One of your solar panels broke, \nbut you were able to replace it with a spare.")):a>0&&(a--,this.solar_status.setText("Solar Panels: "+a),this.message.setText("One of your solar panels broke, \nbut you were unable to replace it.")))):(this.stolenProb=10,Math.floor(100*Math.random())+1<=this.stolenProb&&(this.stolen=Math.floor(5*Math.random())+1,1==this.stolen&&a>0?n>0?(n--,this.parts_status.setText("Spare Parts: "+n),this.message.setText("Space pirates stole a solar panel, \nbut you were able to replace it with a spare.")):(a--,this.solar_status.setText("Solar Panels: "+a),this.message.setText("Space pirates stole a solar panel, \nbut you were unable to replace it.")):2==this.stolen&&o>0?(o-=100,0>o&&(o=0),this.food_status.setText("Food: "+o),this.message.setText("Space pirates stole some food.")):3==this.stolen&&h>0?(h--,this.clothing_status.setText("Clothing: "+h),this.message.setText("Space pirates stole clothing.")):4==this.stolen&&n>0?(n--,this.parts_status.setText("Spare Parts: "+n),this.message.setText("Space pirates stole spare parts.")):5==this.stolen&&r>0&&(r-=10,0>r&&(r=0),this.spice_status.setText("Spice: "+r),this.message.setText("Someone in the crew has been dipping into the spice supply."))))}},i.StateAsteroids={},i.StateAsteroids=function(){this.bg,this.ship,this.stars,this.bullet,this.bullets,this.bulletTime=0,this.bulletSound,this.asteroid,this.asteroids,this.asteroidTime=0,this.lives,this.hurt=!1,this.hurtTime=0,this.hurtDuration=0,this.cursors},i.StateAsteroids.prototype={preload:function(){this.game.load.image("ship","assets/ship.png"),this.game.load.image("asteroid","assets/asteroid.png"),this.game.load.image("background","assets/background.png"),this.game.load.image("stars","assets/stars.png"),this.game.load.image("bullet","assets/bullet.png"),this.game.load.image("asteroid","assets/asteroid.png"),this.game.load.audio("bulletSound","assets/audio/170161__timgormly__8-bit-laser.mp3"),this.game.load.audio("explosionSound","assets/audio/170144__timgormly__8-bit-explosion2.mp3")},create:function(){this.game.renderer.clearBeforeRender=!1,this.game.renderer.roundPixels=!0,this.game.physics.startSystem(Phaser.Physics.ARCADE),this.bg=this.game.add.tileSprite(0,0,800,600,"background"),this.stars=this.game.add.tileSprite(0,0,800,600,"stars"),this.ship=this.game.add.sprite(this.game.world.centerX,this.game.world.centerY,"ship"),this.ship.anchor.setTo(.5,.5),this.game.physics.enable(this.ship,Phaser.Physics.ARCADE),this.ship.body.drag.set(100),this.ship.body.maxVelocity.set(400),this.bullets=this.game.add.group(),this.bullets.enableBody=!0,this.bullets.physicsBodyType=Phaser.Physics.ARCADE,this.bullets.createMultiple(20,"bullet"),this.bullets.setAll("anchor.x",.5),this.bullets.setAll("anchor.y",.5),this.asteroids=this.game.add.group(),this.asteroids.enableBody=!0,this.asteroids.physicsBodyType=Phaser.Physics.ARCADE,this.asteroids.createMultiple(5,"asteroid"),this.asteroids.setAll("anchor.x",.5),this.asteroids.setAll("anchor.y",.5),this.bulletSound=u.add.audio("bulletSound"),this.explosionSound=u.add.audio("explosionSound"),this.lives=this.game.add.group();for(var t=0;3>t;t++){var s=this.lives.create(this.game.world.width-100+30*t,60,"ship");s.anchor.setTo(.5,.5),s.angle=90,s.scale.x=.2,s.scale.y=.2,s.alpha=.8}this.cursors=this.game.input.keyboard.createCursorKeys(),this.game.input.keyboard.addKeyCapture([Phaser.Keyboard.Q,Phaser.Keyboard.SPACEBAR,Phaser.Keyboard.W,Phaser.Keyboard.A,Phaser.Keyboard.D]),this.escape=u.input.keyboard.addKey(Phaser.Keyboard.Q),this.escape.onDown.add(this.gotoTravel,this)},update:function(){this.stars.tilePosition.x+=.5,this.bg.tilePosition.x-=.5,this.cursors.up.isDown||this.game.input.keyboard.isDown(Phaser.Keyboard.W)?this.game.physics.arcade.accelerationFromRotation(this.ship.rotation,200,this.ship.body.acceleration):this.ship.body.acceleration.set(0),this.ship.body.angularVelocity=this.cursors.left.isDown||this.game.input.keyboard.isDown(Phaser.Keyboard.A)?-300:this.cursors.right.isDown||this.game.input.keyboard.isDown(Phaser.Keyboard.D)?300:0,this.game.input.keyboard.isDown(Phaser.Keyboard.SPACEBAR)&&this.fireBullet(),this.screenWrap(this.ship),this.animateHurt(),this.createAsteroid(),this.asteroids.forEachExists(this.screenWrap,this),this.game.physics.arcade.overlap(this.bullets,this.asteroids,this.collisionHandler,null,this),this.game.physics.arcade.overlap(this.asteroids,this.ship,this.playerHitHander,null,this)},fireBullet:function(){this.game.time.now>this.bulletTime&&(this.bullet=this.bullets.getFirstExists(!1),this.bullet&&(this.bulletSound.play(),this.bullet.reset(this.ship.body.x+64,this.ship.body.y+48),this.bullet.lifespan=2e3,this.bullet.rotation=this.ship.rotation,this.game.physics.arcade.velocityFromRotation(this.ship.rotation,400,this.bullet.body.velocity),this.bulletTime=this.game.time.now+200))},createAsteroid:function(){if(this.game.time.now>this.asteroidTime&&(this.asteroid=this.asteroids.getFirstExists(!1),this.asteroid)){this.asteroid.reset(Math.floor(Math.random()*this.game.width+1),Math.floor(2*Math.random())*this.game.height),this.asteroid.rotation=Math.floor(360*Math.random()+0);var t=Math.random()*(.7-.3)+.3;this.asteroid.scale.x=t,this.asteroid.scale.y=t,this.game.physics.arcade.velocityFromRotation(this.asteroid.rotation,10,this.asteroid.body.velocity),this.asteroidTime=this.game.time.now+1e3}},screenWrap:function(t){t.x<0?t.x=this.game.width:t.x>this.game.width&&(t.x=0),t.y<0?t.y=this.game.height:t.y>this.game.height&&(t.y=0)},collisionHandler:function(t,s){this.explosionSound.play(),t.kill(),s.kill(),o+=Math.floor(5*Math.random())+1},playerHitHander:function(t,s){s.kill(),live=this.lives.getFirstAlive(),live&&live.kill(),this.hurt=!0,this.hurtDuration=this.game.time.now+800,this.lives.countLiving()<1&&this.state.start("StateTravel")},gotoTravel:function(){this.state.start("StateTravel")},animateHurt:function(){this.hurt&&this.game.time.now>this.hurtTime&&(this.ship.alpha=1==this.ship.alpha?.5:1,this.hurtTime=this.game.time.now+150),this.hurt&&this.game.time.now>this.hurtDuration&&(this.hurt=!1,this.ship.alpha=1)}},i.StateGameOver={},i.StateGameOver=function(){this.timer=0},i.StateGameOver.prototype={preload:function(){this.game.load.bitmapFont("dosfont","assets/font/dos.png","assets/font/dos.fnt"),this.game.load.image("background","assets/background.png"),this.game.load.image("stars","assets/stars.png"),this.game.load.image("grave","assets/grave.png")},create:function(){this.bg=this.game.add.tileSprite(0,0,800,600,"background"),this.stars=this.game.add.tileSprite(0,0,800,600,"stars"),this.grave=u.add.sprite(u.world.centerX,u.world.centerY,"grave"),this.grave.anchor.setTo(.5,.5),this.game_over_text=this.game.add.bitmapText(u.world.centerX,u.world.centerY,"dosfont","Game Over",50),this.game_over_text.x=this.game.width/2-this.game_over_text.textWidth/2,this.game_over_text.tint=1118481,this.press_enter_text=this.game.add.bitmapText(u.world.centerX,u.world.centerY+60,"dosfont","Press Enter to Retry",26),this.press_enter_text.x=this.game.width/2-this.press_enter_text.textWidth/2,this.press_enter_text.tint=1118481,u.input.keyboard.addKeyCapture([Phaser.Keyboard.ENTER]),this.enter=u.input.keyboard.addKey(Phaser.Keyboard.ENTER),this.enter.onDown.add(this.retry,this)},update:function(){this.stars.tilePosition.x+=.5,this.bg.tilePosition.x-=.5,this.timer+=this.game.time.elapsed,this.timer>=500&&(this.timer=0,this.press_enter_text.visible=!this.press_enter_text.visible)},retry:function(){e=1e4,a=0,o=0,h=0,n=0,r=0,d=[],p=0,m=3,l=.05,this.state.start("StateJob")}},i.StateWin={},i.StateWin=function(){this.timer=0},i.StateWin.prototype={preload:function(){this.game.load.image("station","assets/station.png"),this.game.load.audio("music","assets/audio/SpaceGone-8bit-Chiptune-Song-36.mp3"),this.game.load.bitmapFont("dosfont","assets/font/dos.png","assets/font/dos.fnt")},create:function(){this.station=this.game.add.sprite(0,0,"station"),this.music=this.game.add.audio("music"),this.music.loop=!0,this.music.play(),this.game.add.bitmapText(50,100,"dosfont","Results",26),this.game.add.bitmapText(50,130,"dosfont","Solar Panels: "+a+" X 50 = "+50*a,26),this.game.add.bitmapText(50,160,"dosfont","Food: "+a+" X 10 = "+10*o,26),this.game.add.bitmapText(50,190,"dosfont","Clothing: "+a+" X 50 = "+50*h,26),this.game.add.bitmapText(50,220,"dosfont","Spare Parts: "+n+" X 50 = "+50*n,26),this.game.add.bitmapText(50,250,"dosfont","Spice: "+r+" X 100 = "+100*r,26),this.game.add.bitmapText(50,280,"dosfont","Money: "+e,26),this.game.add.bitmapText(50,310,"dosfont","Days: -"+p,26),this.game.add.bitmapText(50,340,"dosfont","Score: "+(50*a+10*o+50*h+50*n+100*r+e-p),26),this.play_again_text=this.game.add.bitmapText(u.world.centerX,400,"dosfont","Press Enter to Play Again"),this.play_again_text.x=this.game.width/2-this.play_again_text.textWidth/2-100,u.input.keyboard.addKeyCapture([Phaser.Keyboard.ENTER]),this.enter=u.input.keyboard.addKey(Phaser.Keyboard.ENTER),this.enter.onDown.add(this.retry,this)},update:function(){this.timer+=this.game.time.elapsed,this.timer>=500&&(this.timer=0,this.play_again_text.visible=!this.play_again_text.visible)},retry:function(){e=1e4,a=0,o=0,h=0,n=0,r=0,d=[],p=0,m=3,l=.05,this.music.stop(),this.state.start("StateJob")}};var u=new Phaser.Game(800,600,Phaser.AUTO,"kessel-run-container");u.state.add("StateTitle",i.StateTitle),u.state.add("StateJob",i.StateJob),u.state.add("StateCaptain",i.StateCaptain),u.state.add("StateParty",i.StateParty),u.state.add("StateShop",i.StateShop),u.state.add("StateStartStation",i.StateStartStation),u.state.add("StateTravel",i.StateTravel),u.state.add("StateAsteroids",i.StateAsteroids),u.state.add("StateGameOver",i.StateGameOver),u.state.add("StateWin",i.StateWin),u.state.start("StateTitle")
};