window.onload=function(){var e;var t;var n=1e4;var r={};var i=0;var s=0;var o=0;var u=0;var a=0;var f=[];var l=0;var c=3;var h=.05;r.StateTitle=function(e){this.title;this.text;this.timer=0};r.StateTitle.prototype={preload:function(){this.game.load.image("title","assets/title.png");this.game.load.bitmapFont("dosfont","assets/font/dos.png","assets/font/dos.fnt")},create:function(){this.title=p.add.sprite(p.world.centerX,p.world.centerY,"title");this.title.anchor.setTo(.5,.5);this.game.input.keyboard.addKeyCapture([Phaser.Keyboard.SPACEBAR]);this.text=this.game.add.bitmapText(p.world.centerX,500,"dosfont","Press Spacebar",32);this.text.x=this.game.width/2-this.text.textWidth/2},update:function(){if(p.input.keyboard.isDown(Phaser.Keyboard.SPACEBAR)){this.gotoStateJob()}this.timer+=this.game.time.elapsed;if(this.timer>=500){this.timer=0;this.text.visible=!this.text.visible}},gotoStateJob:function(){this.state.start("StateJob")}};r.StateJob={};r.StateJob=function(e){this.bg;this.stars;this.timer=0;this.choiceText="";this.choice=-1;this.backspace;this.enter};r.StateJob.prototype={preload:function(){this.game.load.bitmapFont("dosfont","assets/font/dos.png","assets/font/dos.fnt");this.game.load.image("background","assets/background.png");this.game.load.image("stars","assets/stars.png");this.game.load.image("divider","assets/divider.png")},create:function(){this.bg=this.game.add.tileSprite(0,0,800,600,"background");this.stars=this.game.add.tileSprite(0,0,800,600,"stars");p.add.sprite(0,10,"divider");p.add.sprite(0,545,"divider");this.text=this.game.add.bitmapText(100,100,"dosfont","You May: \n\n1. Be an investment banker from\n   New Boston\n2. Be a doctor from Osiris\n3. Be a space cowboy from Mos Eisley\n\nWhat is your choice?",32);this.cursor=this.game.add.bitmapText(450,320,"dosfont","_",32);this.choiceText=this.game.add.bitmapText(450,325,"dosfont","",32);p.input.keyboard.addKeyCapture([Phaser.Keyboard.BACKSPACE,Phaser.Keyboard.ENTER]);this.enter=p.input.keyboard.addKey(Phaser.Keyboard.ENTER);this.enter.onDown.add(this.submitChoice,this);this.backspace=p.input.keyboard.addKey(Phaser.Keyboard.BACKSPACE);this.backspace.onDown.add(this.deleteChoice,this);p.input.keyboard.addCallbacks(this,null,null,this.keyPress)},update:function(){this.stars.tilePosition.x+=.5;this.bg.tilePosition.x-=.5;this.timer+=this.game.time.elapsed;if(this.timer>=500){this.timer=0;this.cursor.visible=!this.cursor.visible}},deleteChoice:function(){if(this.choice!=-1){this.choice=-1;this.cursor.x-=26;this.choiceText.setText("")}},submitChoice:function(){if(this.choice!=-1){e=this.choice;if(e==1){n+=5e3}this.state.start("StateCaptain")}},keyPress:function(e){if(e==="1"){this.choiceText.setText("1");if(this.choice==-1){this.cursor.x+=26}this.choice=1}else if(e==="2"){this.choiceText.setText("2");if(this.choice==-1){this.cursor.x+=26}this.choice=2}else if(e==="3"){this.choiceText.setText("3");if(this.choice==-1){this.cursor.x+=26}this.choice=3}}};r.StateCaptain={};r.StateCaptain=function(e){this.bg;this.stars;this.party;this.text;this.cursor;this.choiceText;this.timer=0;this.name=""};r.StateCaptain.prototype={preload:function(){this.game.load.bitmapFont("dosfont","assets/font/dos.png","assets/font/dos.fnt");this.game.load.image("background","assets/background.png");this.game.load.image("stars","assets/stars.png");this.game.load.image("party","assets/party.png")},create:function(){this.bg=this.game.add.tileSprite(0,0,800,600,"background");this.stars=this.game.add.tileSprite(0,0,800,600,"stars");this.party=this.game.add.sprite(0,0,"party");this.text=this.game.add.bitmapText(100,305,"dosfont","What is the name of you captain?",32);this.cursor=this.game.add.bitmapText(100,337,"dosfont","_",32);this.choiceText=this.game.add.bitmapText(100,337,"dosfont","",32);p.input.keyboard.addKeyCapture([Phaser.Keyboard.BACKSPACE,Phaser.Keyboard.ENTER,Phaser.Keyboard.SPACEBAR]);this.enter=p.input.keyboard.addKey(Phaser.Keyboard.ENTER);this.enter.onDown.add(this.submitChoice,this);this.backspace=p.input.keyboard.addKey(Phaser.Keyboard.BACKSPACE);this.backspace.onDown.add(this.deleteChoice,this);this.spacebar=p.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);this.spacebar.onDown.add(this.addSpace,this);p.input.keyboard.addCallbacks(this,null,null,this.keyPress)},update:function(){this.stars.tilePosition.x+=.5;this.bg.tilePosition.x-=.5;this.timer+=this.game.time.elapsed;if(this.timer>=500){this.timer=0;this.cursor.visible=!this.cursor.visible}},keyPress:function(e){this.name+=e;this.choiceText.setText(this.name);this.cursor.x=126+this.choiceText.width},deleteChoice:function(){this.name=this.name.substring(0,this.name.length-1);this.choiceText.setText(this.name);this.cursor.x=100+this.choiceText.width;if(this.name.length>0){this.cursor.x+=26}},submitChoice:function(){t="Cpt. "+this.name;f.push({name:t,status:"healthy",hp:7});this.state.start("StateParty")},addSpace:function(){this.name+=" ";this.choiceText.setText(this.name);this.cursor.x=126+this.choiceText.width}};r.StateParty={};r.StateParty=function(e){this.bg;this.stars;this.party;this.text;this.cursor;this.choiceText=[];this.timer=0;this.members=["","","","",""];this.current_member=1};r.StateParty.prototype={preload:function(){this.game.load.bitmapFont("dosfont","assets/font/dos.png","assets/font/dos.fnt");this.game.load.image("background","assets/background.png");this.game.load.image("stars","assets/stars.png");this.game.load.image("party","assets/party.png")},create:function(){this.bg=this.game.add.tileSprite(0,0,800,600,"background");this.stars=this.game.add.tileSprite(0,0,800,600,"stars");this.party=this.game.add.sprite(0,0,"party");this.text=this.game.add.bitmapText(100,305,"dosfont","What are the names of the rest of your\ncrew?",32);this.cursor=this.game.add.bitmapText(132,401,"dosfont","_",32);this.members[0]=t;for(var e=0;e<5;e++){this.choiceText.push(this.game.add.bitmapText(100,369+e*32,"dosfont",e+1+". "+this.members[e]))}p.input.keyboard.addKeyCapture([Phaser.Keyboard.BACKSPACE,Phaser.Keyboard.ENTER,Phaser.Keyboard.SPACEBAR]);this.enter=p.input.keyboard.addKey(Phaser.Keyboard.ENTER);this.enter.onDown.add(this.submitChoice,this);this.backspace=p.input.keyboard.addKey(Phaser.Keyboard.BACKSPACE);this.backspace.onDown.add(this.deleteChoice,this);this.spacebar=p.input.keyboard.addKey(Phaser.Keyboard.SPACEBAR);this.spacebar.onDown.add(this.addSpace,this);p.input.keyboard.addCallbacks(this,null,null,this.keyPress)},update:function(){this.stars.tilePosition.x+=.5;this.bg.tilePosition.x-=.5;this.timer+=this.game.time.elapsed;if(this.timer>=500){this.timer=0;this.cursor.visible=!this.cursor.visible}},keyPress:function(e){this.members[this.current_member]+=e;this.choiceText[this.current_member].setText(this.current_member+1+". "+this.members[this.current_member]);this.cursor.x=126+this.choiceText[this.current_member].width},deleteChoice:function(){this.members[this.current_member]=this.members[this.current_member].substring(0,this.members[this.current_member].length-1);this.choiceText[this.current_member].setText(this.current_member+1+". "+this.members[this.current_member]);this.cursor.x=126+this.choiceText[this.current_member].width;if(this.members[this.current_member].length>0){this.cursor.x+=26}},submitChoice:function(){f.push({name:this.members[this.current_member],status:"healthy",hp:7});if(this.current_member<4){this.current_member++;this.cursor.y+=32;this.cursor.x=132}else{this.state.start("StateShop")}},addSpace:function(){this.members[this.current_member]+=" ";this.choiceText[this.current_member].setText(this.current_member+1+". "+this.members[this.current_member]);this.cursor.x=126+this.choiceText[this.current_member].width}};r.StateShop={};r.StateShop=function(e){this.solar_amount=0;this.food_amount=0;this.clothing_amount=0;this.parts_amount=0;this.spice_amount=0;this.solar_text;this.food_text;this.clothing_text;this.parts_text;this.spice_text;this.total=0;this.total_text;this.enter_text;this.timer=0};r.StateShop.prototype={preload:function(){this.game.load.image("merchant","assets/merchant.png");this.game.load.image("arrow","assets/arrow.png");this.game.load.bitmapFont("dosfont","assets/font/dos.png","assets/font/dos.fnt")},create:function(){this.merchant=this.game.add.sprite(100,300,"merchant");this.merchant.anchor.setTo(.5,.5);this.merchant.scale.x=.5;this.merchant.scale.y=.5;this.game.add.bitmapText(200,20,"dosfont","Wimateeka's Shoppe",40);this.game.add.bitmapText(200,70,"dosfont","1. Solar Panels @ $500",32);this.game.add.bitmapText(200,132,"dosfont","2. Food         @ $10",32);this.game.add.bitmapText(200,194,"dosfont","3. Clothing     @ $40",32);this.game.add.bitmapText(200,256,"dosfont","4. Spare Parts  @ $100",32);this.game.add.bitmapText(200,318,"dosfont","5. Spice        @ $100",32);this.solar_text=this.game.add.bitmapText(600,70,"dosfont","0",32);this.solar_up=this.game.add.sprite(590,55,"arrow");this.solar_up.inputEnabled=true;this.solar_up.events.onInputOver.add(this.fade,this);this.solar_up.events.onInputDown.add(this.solarUp,this);this.solar_up.events.onInputOut.add(this.fade,this);this.solar_down=this.game.add.sprite(608,100,"arrow");this.solar_down.anchor.setTo(.5,.5);this.solar_down.angle=180;this.solar_down.inputEnabled=true;this.solar_down.events.onInputOver.add(this.fade,this);this.solar_down.events.onInputDown.add(this.solarDown,this);this.solar_down.events.onInputOut.add(this.fade,this);this.food_text=this.game.add.bitmapText(600,132,"dosfont","0",32);this.food_up=this.game.add.sprite(590,117,"arrow");this.food_up.inputEnabled=true;this.food_up.events.onInputOver.add(this.fade,this);this.food_up.events.onInputDown.add(this.foodUp,this);this.food_up.events.onInputOut.add(this.fade,this);this.food_down=this.game.add.sprite(608,162,"arrow");this.food_down.anchor.setTo(.5,.5);this.food_down.angle=180;this.food_down.inputEnabled=true;this.food_down.events.onInputOver.add(this.fade,this);this.food_down.events.onInputDown.add(this.foodDown,this);this.food_down.events.onInputOut.add(this.fade,this);this.clothing_text=this.game.add.bitmapText(600,194,"dosfont","0",32);this.clothing_up=this.game.add.sprite(590,179,"arrow");this.clothing_up.inputEnabled=true;this.clothing_up.events.onInputOver.add(this.fade,this);this.clothing_up.events.onInputDown.add(this.clothingUp,this);this.clothing_up.events.onInputOut.add(this.fade,this);this.clothing_down=this.game.add.sprite(608,225,"arrow");this.clothing_down.anchor.setTo(.5,.5);this.clothing_down.angle=180;this.clothing_down.inputEnabled=true;this.clothing_down.events.onInputOver.add(this.fade,this);this.clothing_down.events.onInputDown.add(this.clothingDown,this);this.clothing_down.events.onInputOut.add(this.fade,this);this.parts_text=this.game.add.bitmapText(600,256,"dosfont","0",32);this.parts_up=this.game.add.sprite(590,241,"arrow");this.parts_up.inputEnabled=true;this.parts_up.events.onInputOver.add(this.fade,this);this.parts_up.events.onInputDown.add(this.partsUp,this);this.parts_up.events.onInputOut.add(this.fade,this);this.parts_down=this.game.add.sprite(608,288,"arrow");this.parts_down.anchor.setTo(.5,.5);this.parts_down.angle=180;this.parts_down.inputEnabled=true;this.parts_down.events.onInputOver.add(this.fade,this);this.parts_down.events.onInputDown.add(this.partsDown,this);this.parts_down.events.onInputOut.add(this.fade,this);this.spice_text=this.game.add.bitmapText(600,318,"dosfont","0",32);this.spice_up=this.game.add.sprite(590,303,"arrow");this.spice_up.inputEnabled=true;this.spice_up.events.onInputOver.add(this.fade,this);this.spice_up.events.onInputDown.add(this.spiceUp,this);this.spice_up.events.onInputOut.add(this.fade,this);this.spice_down=this.game.add.sprite(608,349,"arrow");this.spice_down.anchor.setTo(.5,.5);this.spice_down.angle=180;this.spice_down.inputEnabled=true;this.spice_down.events.onInputOver.add(this.fade,this);this.spice_down.events.onInputDown.add(this.spiceDown,this);this.spice_down.events.onInputOut.add(this.fade,this);this.money=this.game.add.bitmapText(200,450,"dosfont","Your Funds: $"+n.toFixed(2),32);this.total_text=this.game.add.bitmapText(200,500,"dosfont","     Total: $0.00",32);this.enter_text=this.game.add.bitmapText(p.world.centerX,550,"dosfont","Press Enter to Continue",32);this.enter_text.x=this.game.width/2-this.enter_text.textWidth/2;this.enter=p.input.keyboard.addKey(Phaser.Keyboard.ENTER);this.enter.onDown.add(this.submitPurchase,this)},update:function(){this.timer+=this.game.time.elapsed;if(this.timer>=500){this.timer=0;this.enter_text.visible=!this.enter_text.visible}},solarUp:function(e,t){if(this.total+500<=n){this.solar_amount++;this.solar_text.setText(this.solar_amount);this.total+=500;this.total_text.setText("     Total: $"+this.total.toFixed(2))}},solarDown:function(e,t){if(this.solar_amount>0){this.solar_amount--;this.solar_text.setText(this.solar_amount);this.total-=500;this.total_text.setText("     Total: $"+this.total.toFixed(2))}},foodUp:function(e,t){if(this.total+10<=n){this.food_amount++;this.food_text.setText(this.food_amount);this.total+=10;this.total_text.setText("     Total: $"+this.total.toFixed(2))}},foodDown:function(e,t){if(this.food_amount>0){this.food_amount--;this.food_text.setText(this.food_amount);this.total-=10;this.total_text.setText("     Total: $"+this.total.toFixed(2))}},clothingUp:function(e,t){if(this.total+40<=n){this.clothing_amount++;this.clothing_text.setText(this.clothing_amount);this.total+=40;this.total_text.setText("     Total: $"+this.total.toFixed(2))}},clothingDown:function(e,t){if(this.clothing_amount>0){this.clothing_amount--;this.clothing_text.setText(this.clothing_amount);this.total-=40;this.total_text.setText("     Total: $"+this.total.toFixed(2))}},partsUp:function(e,t){if(this.total+100<=n){this.parts_amount++;this.parts_text.setText(this.parts_amount);this.total+=100;this.total_text.setText("     Total: $"+this.total.toFixed(2))}},partsDown:function(e,t){if(this.parts_amount>0){this.parts_amount--;this.parts_text.setText(this.parts_amount);this.total-=100;this.total_text.setText("     Total: $"+this.total.toFixed(2))}},spiceUp:function(e,t){if(this.total+100<=n){this.spice_amount++;this.spice_text.setText(this.spice_amount);this.total+=100;this.total_text.setText("     Total: $"+this.total.toFixed(2))}},spiceDown:function(e,t){if(this.spice_amount>0){this.spice_amount--;this.spice_text.setText(this.spice_amount);this.total-=100;this.total_text.setText("     Total: $"+this.total.toFixed(2))}},fade:function(e,t){if(e.alpha!=.8){e.alpha=.8}else{e.alpha=1}},submitPurchase:function(){n-=this.total;i=this.solar_amount;s=this.food_amount;o=this.clothing_amount;u=this.parts_amount;a=this.spice_amount;this.state.start("StateStartStation")}};r.StateStartStation={};r.StateStartStation=function(e){this.station;this.music;this.enter_text;this.timer=0};r.StateStartStation.prototype={preload:function(){this.game.load.image("station","assets/station.png");this.game.load.audio("music","assets/audio/SpaceGone-8bit-Chiptune-Song-36.mp3");this.game.load.bitmapFont("dosfont","assets/font/dos.png","assets/font/dos.fnt")},create:function(){this.station=this.game.add.sprite(0,0,"station");this.music=this.game.add.audio("music");this.music.loop=true;this.music.play();this.enter_text=this.game.add.bitmapText(p.world.centerX,p.world.centerY,"dosfont","Press Enter to Take Off",64);this.enter_text.x=this.game.width/2-this.enter_text.textWidth/2;this.enter=p.input.keyboard.addKey(Phaser.Keyboard.ENTER);this.enter.onDown.add(this.takeOff,this)},update:function(){this.timer+=this.game.time.elapsed;if(this.timer>=500){this.timer=0;this.enter_text.visible=!this.enter_text.visible}},takeOff:function(){this.music.stop();this.state.start("StateTravel")}};r.StateTravel={};r.StateTravel=function(e){this.progressLine;this.shipProgress;this.ship;this.solar_status;this.food_status;this.clothing_status;this.parts_status;this.spice_status;this.crew_statuses;this.rest;this.distanceTraveled=0;this.timer=0;this.dayTimer=0;this.restTimer=0;this.day_status;this.resting=false;this.meal_buttons;this.speed_buttons;this.sicknesses=["Space Madness","Space Dysentery","Space Cholera","Exhaustion"]};r.StateTravel.prototype={preload:function(){this.game.load.image("ship","assets/ship.png");this.game.load.bitmapFont("dosfont","assets/font/dos.png","assets/font/dos.fnt");this.game.load.image("background","assets/background.png");this.game.load.image("stars","assets/stars.png");this.game.load.image("divider","assets/divider.png");this.game.load.image("rest","assets/rest.png");this.game.load.image("food","assets/food.png");this.game.load.image("1meals","assets/1meal.png");this.game.load.image("2meals","assets/2meals.png");this.game.load.image("3meals","assets/3meals.png");this.game.load.image("speed1","assets/slow.png");this.game.load.image("speed2","assets/moderate.png");this.game.load.image("speed3","assets/fast.png")},create:function(){this.bg=this.game.add.tileSprite(0,0,800,600,"background");this.stars=this.game.add.tileSprite(0,0,800,600,"stars");this.progressLine=this.game.add.graphics(0,0);this.progressLine.lineStyle(1,16777215,.75);this.progressLine.moveTo(50,50);this.progressLine.lineTo(p.width-50,50);this.shipProgress=this.game.add.sprite(p.width-50,50,"ship");this.shipProgress.anchor.setTo(.5,.5);this.shipProgress.scale.x=.2;this.shipProgress.scale.y=.2;this.shipProgress.angle=180;this.ship=this.game.add.sprite(this.game.world.centerX,this.game.world.centerY,"ship");this.ship.angle=180;this.ship.anchor.setTo(.5,.5);this.solar_status=this.game.add.bitmapText(50,60,"dosfont","Solar Panels: "+i,26);this.food_status=this.game.add.bitmapText(50,60+26,"dosfont","Food: "+s,26);this.clothing_status=this.game.add.bitmapText(50,60+26*2,"dosfont","Clothing: "+o,26);this.parts_status=this.game.add.bitmapText(50,60+26*3,"dosfont","Spare Parts: "+u,26);this.spice_status=this.game.add.bitmapText(50,60+26*4,"dosfont","Spice: "+a,26);this.money_status=this.game.add.bitmapText(50,60+26*5,"dosfont","Money: $"+n.toFixed(2),26);this.day_status=this.game.add.bitmapText(700,60,"dosfont","Day: "+l,26);this.line1=this.game.add.sprite(50,60+26*6,"divider");this.line1.scale.x=.3;this.line1.scale.y=.3;this.crew_statuses=p.add.group();for(var e=0;e<f.length;e++){this.status=this.game.add.bitmapText(50,236+26*e,"dosfont",f[e].name+": "+f[e].status,26);this.crew_statuses.add(this.status)}this.rest=this.game.add.sprite(50,380,"rest");this.rest.inputEnabled=true;this.rest.events.onInputOver.add(this.fade,this);this.rest.events.onInputDown.add(this.enableRest,this);this.rest.events.onInputOut.add(this.fade,this);this.food=this.game.add.sprite(50,414,"food");this.food.inputEnabled=true;this.food.events.onInputOver.add(this.fade,this);this.food.events.onInputDown.add(this.gotoAsteroids,this);this.food.events.onInputOut.add(this.fade,this);this.game.add.bitmapText(700,98,"dosfont","Rations",26);this.meal_buttons=p.add.group();for(var e=0;e<3;e++){this.meal_button=this.game.add.sprite(700,126+e*34,e+1+"meals");this.meal_buttons.add(this.meal_button);this.meal_button.inputEnabled=true;this.meal_button.events.onInputOver.add(this.fade,this);this.meal_button.events.onInputDown.add(this.mealChanged,{amount:e+1});this.meal_button.events.onInputOut.add(this.fade,this);if(e==2){this.meal_button.tint=5592405}}this.game.add.bitmapText(700,230,"dosfont","Speed",26);this.speed_buttons=p.add.group();for(var e=0;e<3;e++){this.speed_button=this.game.add.sprite(700,256+e*34,"speed"+(e+1));this.speed_buttons.add(this.speed_button);this.speed_button.inputEnabled=true;this.speed_button.events.onInputOver.add(this.fade,this);this.speed_button.events.onInputDown.add(this.speedChanged,{index:e});this.speed_button.events.onInputOut.add(this.fade,this);if(e==2){this.speed_button.tint=5592405}}this.message=this.game.add.bitmapText(100,500,"dosfont","",26)},update:function(){if(i==0&&!this.resting){h=.03}if(!this.resting){this.stars.tilePosition.x+=h*100;this.bg.tilePosition.x-=h*100}else{this.stars.tilePosition.x+=.5;this.bg.tilePosition.x-=.5}for(var t=0;t<3;t++){if(t==c-1){this.meal_buttons.getAt(t).tint=5592405}else{this.meal_buttons.getAt(t).tint=16777215}}this.speed_buttons.setAll("tint",16777215);if(h==.03){this.speed_buttons.getAt(0).tint=5592405}else if(h==.04){this.speed_buttons.getAt(1).tint=5592405}else{this.speed_buttons.getAt(2).tint=5592405}if(!this.resting){this.timer+=this.game.time.elapsed;if(this.timer>=500){this.timer=0;this.distanceTraveled+=h;if(this.distanceTraveled>58){this.distanceTraveled=58}this.shipProgress.x=750-this.distanceTraveled/58*700}}if(this.resting){this.restTimer+=this.game.time.elapsed;if(this.restTimer>=5e3){this.restTimer=0;this.resting=false;this.rest.tint=16777215;this.probabilityHealing=50;if(e==2){this.probabilityHealing+=20}for(var t=0;t<f.length;t++){if(f[t].status!="starving"||f[t].status!="healthy"){if(Math.floor(Math.random()*100)+1<=this.probabilityHealing){f[t].status="healthy";this.crew_statuses.getAt(t).setText(f[t].name+": "+f[t].status)}}}}}this.dayTimer+=this.game.time.elapsed;if(this.dayTimer>=5e3){this.dayTimer=0;l++;this.randomEvent();for(var t=0;t<f.length;t++){if(f[t].status!="starving"&&f[t].status!="healthy"){f[t].hp--}if(s>0&&f[t].hp>0){s-=c;if(s<0){s=0}if(f[t].status=="starving"){f[t].status="healthy"}}else if(s==0&&f[t].hp>0){f[t].hp--;if(f[t].status=="healthy"){f[t].status="starving"}}else{f[t].status="dead"}this.crew_statuses.getAt(t).setText(f[t].name+": "+f[t].status)}this.day_status.setText("Day:"+l);this.food_status.setText("Food: "+s)}this.gameover=true;for(var t=0;t<f.length;t++){if(f[t].status!="dead"){this.gameover=false;break}}if(this.gameover){this.gotoGameOver()}if(this.distanceTraveled==58){this.gotoWin()}},gotoAsteroids:function(){this.state.start("StateAsteroids")},fade:function(e,t){if(e.alpha!=.8){e.alpha=.8}else{e.alpha=1}},enableRest:function(){if(!this.resting){this.resting=true;this.rest.tint=5592405}},mealChanged:function(){c=this.amount},speedChanged:function(){if(this.index==0){h=.03}else if(this.index==1){h=.04}else{h=.05}},gotoGameOver:function(){this.state.start("StateGameOver")},gotoWin:function(){this.state.start("StateWin")},randomEvent:function(){this.pick=Math.floor(Math.random()*3)+1;if(this.pick==1){this.sicknessProb=10+3/c+5/o;if(Math.floor(Math.random()*100)+1<=this.sicknessProb){this.crewIndex=Math.floor(Math.random()*f.length);this.sickPerson=f[this.crewIndex];this.sickPerson.status=this.sicknesses[Math.floor(Math.random()*this.sicknesses.length)];this.message.setText(this.sickPerson.name+" has come down with "+this.sickPerson.status);this.crew_statuses.getAt(this.crewIndex).setText(f[this.crewIndex].name+": "+f[this.crewIndex].status)}}else if(this.pick==2){this.brokenPartProb=10+h*100;if(e==3){this.brokenPartProb-=5}if(Math.floor(Math.random()*100)+1<=this.brokenPartProb){if(u>0){u--;this.parts_status.setText("Spare Parts: "+u);this.message.setText("One of your solar panels broke, \nbut you were able to replace it with a spare.")}else if(i>0){i--;this.solar_status.setText("Solar Panels: "+i);this.message.setText("One of your solar panels broke, \nbut you were unable to replace it.")}}}else{this.stolenProb=10;if(Math.floor(Math.random()*100)+1<=this.stolenProb){this.stolen=Math.floor(Math.random()*5)+1;if(this.stolen==1&&i>0){if(u>0){u--;this.parts_status.setText("Spare Parts: "+u);this.message.setText("Space pirates stole a solar panel, \nbut you were able to replace it with a spare.")}else{i--;this.solar_status.setText("Solar Panels: "+i);this.message.setText("Space pirates stole a solar panel, \nbut you were unable to replace it.")}}else if(this.stolen==2&&s>0){s-=100;if(s<0){s=0}this.food_status.setText("Food: "+s);this.message.setText("Space pirates stole some food.")}else if(this.stolen==3&&o>0){o--;this.clothing_status.setText("Clothing: "+o);this.message.setText("Space pirates stole clothing.")}else if(this.stolen==4&&u>0){u--;this.parts_status.setText("Spare Parts: "+u);this.message.setText("Space pirates stole spare parts.")}else if(this.stolen==5&&a>0){a-=10;if(a<0){a=0}this.spice_status.setText("Spice: "+a);this.message.setText("Someone in the crew has been dipping into the spice supply.")}}}}};r.StateAsteroids={};r.StateAsteroids=function(e){this.bg;this.ship;this.stars;this.bullet;this.bullets;this.bulletTime=0;this.bulletSound;this.asteroid;this.asteroids;this.asteroidTime=0;this.lives;this.hurt=false;this.hurtTime=0;this.hurtDuration=0;this.cursors};r.StateAsteroids.prototype={preload:function(){this.game.load.image("ship","assets/ship.png");this.game.load.image("asteroid","assets/asteroid.png");this.game.load.image("background","assets/background.png");this.game.load.image("stars","assets/stars.png");this.game.load.image("bullet","assets/bullet.png");this.game.load.image("asteroid","assets/asteroid.png");this.game.load.audio("bulletSound","assets/audio/170161__timgormly__8-bit-laser.mp3");this.game.load.audio("explosionSound","assets/audio/170144__timgormly__8-bit-explosion2.mp3")},create:function(){this.game.renderer.clearBeforeRender=false;this.game.renderer.roundPixels=true;this.game.physics.startSystem(Phaser.Physics.ARCADE);this.bg=this.game.add.tileSprite(0,0,800,600,"background");this.stars=this.game.add.tileSprite(0,0,800,600,"stars");this.ship=this.game.add.sprite(this.game.world.centerX,this.game.world.centerY,"ship");this.ship.anchor.setTo(.5,.5);this.game.physics.enable(this.ship,Phaser.Physics.ARCADE);this.ship.body.drag.set(100);this.ship.body.maxVelocity.set(400);this.bullets=this.game.add.group();this.bullets.enableBody=true;this.bullets.physicsBodyType=Phaser.Physics.ARCADE;this.bullets.createMultiple(20,"bullet");this.bullets.setAll("anchor.x",.5);this.bullets.setAll("anchor.y",.5);this.asteroids=this.game.add.group();this.asteroids.enableBody=true;this.asteroids.physicsBodyType=Phaser.Physics.ARCADE;this.asteroids.createMultiple(5,"asteroid");this.asteroids.setAll("anchor.x",.5);this.asteroids.setAll("anchor.y",.5);this.bulletSound=p.add.audio("bulletSound");this.explosionSound=p.add.audio("explosionSound");this.lives=this.game.add.group();for(var e=0;e<3;e++){var t=this.lives.create(this.game.world.width-100+30*e,60,"ship");t.anchor.setTo(.5,.5);t.angle=90;t.scale.x=.2;t.scale.y=.2;t.alpha=.8}this.cursors=this.game.input.keyboard.createCursorKeys();this.game.input.keyboard.addKeyCapture([Phaser.Keyboard.Q,Phaser.Keyboard.SPACEBAR,Phaser.Keyboard.W,Phaser.Keyboard.A,Phaser.Keyboard.D]);this.escape=p.input.keyboard.addKey(Phaser.Keyboard.Q);this.escape.onDown.add(this.gotoTravel,this)},update:function(){this.stars.tilePosition.x+=.5;this.bg.tilePosition.x-=.5;if(this.cursors.up.isDown||this.game.input.keyboard.isDown(Phaser.Keyboard.W)){this.game.physics.arcade.accelerationFromRotation(this.ship.rotation,200,this.ship.body.acceleration)}else{this.ship.body.acceleration.set(0)}if(this.cursors.left.isDown||this.game.input.keyboard.isDown(Phaser.Keyboard.A)){this.ship.body.angularVelocity=-300}else if(this.cursors.right.isDown||this.game.input.keyboard.isDown(Phaser.Keyboard.D)){this.ship.body.angularVelocity=300}else{this.ship.body.angularVelocity=0}if(this.game.input.keyboard.isDown(Phaser.Keyboard.SPACEBAR)){this.fireBullet()}this.screenWrap(this.ship);this.animateHurt();this.createAsteroid();this.asteroids.forEachExists(this.screenWrap,this);this.game.physics.arcade.overlap(this.bullets,this.asteroids,this.collisionHandler,null,this);this.game.physics.arcade.overlap(this.asteroids,this.ship,this.playerHitHander,null,this)},fireBullet:function(){if(this.game.time.now>this.bulletTime){this.bullet=this.bullets.getFirstExists(false);if(this.bullet){this.bulletSound.play();this.bullet.reset(this.ship.body.x+64,this.ship.body.y+48);this.bullet.lifespan=2e3;this.bullet.rotation=this.ship.rotation;this.game.physics.arcade.velocityFromRotation(this.ship.rotation,400,this.bullet.body.velocity);this.bulletTime=this.game.time.now+200}}},createAsteroid:function(){if(this.game.time.now>this.asteroidTime){this.asteroid=this.asteroids.getFirstExists(false);if(this.asteroid){this.asteroid.reset(Math.floor(Math.random()*this.game.width+1),Math.floor(Math.random()*2)*this.game.height);this.asteroid.rotation=Math.floor(Math.random()*360+0);var e=Math.random()*(.7-.3)+.3;this.asteroid.scale.x=e;this.asteroid.scale.y=e;this.game.physics.arcade.velocityFromRotation(this.asteroid.rotation,10,this.asteroid.body.velocity);this.asteroidTime=this.game.time.now+1e3}}},screenWrap:function(e){if(e.x<0){e.x=this.game.width}else if(e.x>this.game.width){e.x=0}if(e.y<0){e.y=this.game.height}else if(e.y>this.game.height){e.y=0}},collisionHandler:function(e,t){this.explosionSound.play();e.kill();t.kill();s+=Math.floor(Math.random()*5)+1},playerHitHander:function(e,t){t.kill();live=this.lives.getFirstAlive();if(live){live.kill()}this.hurt=true;this.hurtDuration=this.game.time.now+800;if(this.lives.countLiving()<1){this.state.start("StateTravel")}},gotoTravel:function(){this.state.start("StateTravel")},animateHurt:function(){if(this.hurt&&this.game.time.now>this.hurtTime){if(this.ship.alpha==1){this.ship.alpha=.5}else{this.ship.alpha=1}this.hurtTime=this.game.time.now+150}if(this.hurt&&this.game.time.now>this.hurtDuration){this.hurt=false;this.ship.alpha=1}}};r.StateGameOver={};r.StateGameOver=function(e){this.timer=0};r.StateGameOver.prototype={preload:function(){this.game.load.bitmapFont("dosfont","assets/font/dos.png","assets/font/dos.fnt");this.game.load.image("background","assets/background.png");this.game.load.image("stars","assets/stars.png");this.game.load.image("grave","assets/grave.png")},create:function(){this.bg=this.game.add.tileSprite(0,0,800,600,"background");this.stars=this.game.add.tileSprite(0,0,800,600,"stars");this.grave=p.add.sprite(p.world.centerX,p.world.centerY,"grave");this.grave.anchor.setTo(.5,.5);this.game_over_text=this.game.add.bitmapText(p.world.centerX,p.world.centerY,"dosfont","Game Over",50);this.game_over_text.x=this.game.width/2-this.game_over_text.textWidth/2;this.game_over_text.tint=1118481;this.press_enter_text=this.game.add.bitmapText(p.world.centerX,p.world.centerY+60,"dosfont","Press Enter to Retry",26);this.press_enter_text.x=this.game.width/2-this.press_enter_text.textWidth/2;this.press_enter_text.tint=1118481;p.input.keyboard.addKeyCapture([Phaser.Keyboard.ENTER]);this.enter=p.input.keyboard.addKey(Phaser.Keyboard.ENTER);this.enter.onDown.add(this.retry,this)},update:function(){this.stars.tilePosition.x+=.5;this.bg.tilePosition.x-=.5;this.timer+=this.game.time.elapsed;if(this.timer>=500){this.timer=0;this.press_enter_text.visible=!this.press_enter_text.visible}},retry:function(){n=1e4;i=0;s=0;o=0;u=0;a=0;f=[];l=0;c=3;h=.05;this.state.start("StateJob")}};r.StateWin={};r.StateWin=function(e){this.timer=0};r.StateWin.prototype={preload:function(){this.game.load.image("station","assets/station.png");this.game.load.audio("music","assets/audio/SpaceGone-8bit-Chiptune-Song-36.mp3");this.game.load.bitmapFont("dosfont","assets/font/dos.png","assets/font/dos.fnt")},create:function(){this.station=this.game.add.sprite(0,0,"station");this.music=this.game.add.audio("music");this.music.loop=true;this.music.play();this.game.add.bitmapText(50,100,"dosfont","Results",26);this.game.add.bitmapText(50,100+30,"dosfont","Solar Panels: "+i+" X 50 = "+i*50,26);this.game.add.bitmapText(50,100+30*2,"dosfont","Food: "+i+" X 10 = "+s*10,26);this.game.add.bitmapText(50,100+30*3,"dosfont","Clothing: "+i+" X 50 = "+o*50,26);this.game.add.bitmapText(50,100+30*4,"dosfont","Spare Parts: "+u+" X 50 = "+u*50,26);this.game.add.bitmapText(50,100+30*5,"dosfont","Spice: "+a+" X 100 = "+a*100,26);this.game.add.bitmapText(50,100+30*6,"dosfont","Money: "+n,26);this.game.add.bitmapText(50,100+30*7,"dosfont","Days: -"+l,26);this.game.add.bitmapText(50,340,"dosfont","Score: "+(i*50+s*10+o*50+u*50+a*100+n-l),26);this.play_again_text=this.game.add.bitmapText(p.world.centerX,400,"dosfont","Press Enter to Play Again");this.play_again_text.x=this.game.width/2-this.play_again_text.textWidth/2-100;p.input.keyboard.addKeyCapture([Phaser.Keyboard.ENTER]);this.enter=p.input.keyboard.addKey(Phaser.Keyboard.ENTER);this.enter.onDown.add(this.retry,this)},update:function(){this.timer+=this.game.time.elapsed;if(this.timer>=500){this.timer=0;this.play_again_text.visible=!this.play_again_text.visible}},retry:function(){n=1e4;i=0;s=0;o=0;u=0;a=0;f=[];l=0;c=3;h=.05;this.state.start("StateJob")}};var p=new Phaser.Game(800,600,Phaser.AUTO,"kessel-run-container");p.state.add("StateTitle",r.StateTitle);p.state.add("StateJob",r.StateJob);p.state.add("StateCaptain",r.StateCaptain);p.state.add("StateParty",r.StateParty);p.state.add("StateShop",r.StateShop);p.state.add("StateStartStation",r.StateStartStation);p.state.add("StateTravel",r.StateTravel);p.state.add("StateAsteroids",r.StateAsteroids);p.state.add("StateGameOver",r.StateGameOver);p.state.add("StateWin",r.StateWin);p.state.start("StateTitle")}